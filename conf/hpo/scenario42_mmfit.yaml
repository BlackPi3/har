# HPO for Scenario42 (signal-level adversarial) on MM-Fit
# scenario42 = scenario2 + signal-level discriminator (D on raw acc)
# Unlike scenario4 (D on features), D directly trains the regressor
#
# Multi-pass HPO Strategy:
# - Pass 1: Loss weights + Adversarial params (most impactful)
# - Pass 2: Regularization (after fixing pass 1 winners)
# - Pass 3: Capacity (after fixing pass 1+2 winners)

study_name: scenario42_mmfit
trial: scenario42_mmfit

# HPO-specific overrides (shorter epochs for faster search)
trainer:
  epochs: 60
  patience: 25

top_k: 10
save_artifacts: false  # Save plots to monitor D_acc and feat_dist

repeat:
  enabled: true
  count: 3

hydra:
  sweeper:
    study_name: ${study_name}
    storage: "sqlite:///experiments/hpo/${study_name}/${study_name}.db"
    params:

      # ============================================================
      # PASS 1: Loss weights + Adversarial (ACTIVE)
      # ============================================================
      trainer.alpha: choice(0.1, 0.5, 1, 2)
      trainer.beta: choice(1, 2, 5, 10, 50, 100)
      trainer.gamma: choice(0.5, 1, 2, 5)

      trainer.adversarial.weight: choice(0.3, 0.5, 1.0)
      trainer.adversarial.n_critic: choice(1, 3, 5)        
      trainer.adversarial.pretrain_epochs: choice(0, 5, 10, 15)
      trainer.adversarial.discriminator.aux_weight: choice(0.5, 1.0, 2.0)

      data.sensor_window_length: choice(300, 400, 500)
      data.stride_seconds: choice(0.2)
      data.batch_size: choice(64)

      # ============================================================
      # PASS 2: Regularization (UNCOMMENT after Pass 1)
      # ============================================================
      # Fix Pass 1 winners, then search regularization

      # ============================================================
      # PASS 3: Capacity (UNCOMMENT after Pass 2)
      # ============================================================
      # Fix Pass 1+2 winners, then search model capacity

  sweep:
    dir: "experiments/hpo/${study_name}/trials"
    subdir: trial_${hydra.job.num}
